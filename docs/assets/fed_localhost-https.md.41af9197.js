import{_ as s,c as a,o as n,V as l}from"./chunks/framework.a5fc2cbc.js";const e="/vitepress-note/assets/搜索证书.3d437740.png",p="/vitepress-note/assets/管理用户证书.b47ce684.png",o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANcAAABUCAYAAAARWaLDAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAUBSURBVHhe7Z1LjtQwEED7XH2gnAAJsUBiAeKz6tP0ZWYDSHOJ2QSXYyflT+L0DNWTpN+TgjqxU/50vTgg0T71AGACcgEYgVwARiAXgBHIBWAEcgEYgVwARiAXgBHIBWAEcgEYgVwARtxNrl/fv/WfPn6YPaT8+fk51AbYP3eTSwR6eXmZPbxgP74iGByGTcn198/vBcGufXfq3J9W6Pjy+dxfnvwJwKvYjFw/v3/1deT48uVzuEvzoHJdu/50OoUD4ffEZuTSh9Qt2btcT/3lfOq7mwbg+nG+uDsDXjTLOYD/CXKNvKdcUrZmbBb9Ait2LJecx9clOfLkTMvPMSOfLv1ZXZ+SXccPSXxRr2SJFcttP13OWVlWX69GnpVyza5cUdy0nVTktGycD3/djfU6zYu/T72OTnXhFnYq15AoyZeeJF6l3OOSsJt7zSrjj0J5IeOK0Wjb141xNG9cucJDYf5+EUHFKMamVzzdlzDWKHyUKhl7o29QZZ9ySQJUn/7qqVuUT5Qri6Di+895MobzVtv+Xomr7xd0nUBM5OzIHwpDf/N4mkpsfW2xnXysrXNYy8HkCkkwJ1d4+o/JmzyVVXz/WSdUK7YqHxmSe5JCJXuBlMW2U66di1G/SVGLra7NzYenJVN+Dms51mvhmEBD+ZRsV/f3J1eSJdmwItwoly9baNsJexnb1UlfEyAiZRW5ll7JfFns0xBbS1iOLW372s2NtXUOaznuP2iEVSotC0kYrp9dgt28cnmW2/arTSwrEt5dq658Wf8FkXZsYzp8yIpcnRvPVC+Ll8yHFi0fa+sc1rIjuWCeIFdhJ7wnyHUIkGuLINchQK4tcje5Wv/lRB9SF2Dv3E0ugEcDuQCMQC4AI5ALwAjkAjACuQCMQC4AI5ALwAjkAjACuQCMQC4AI5ALwAjkAjACuQCMQC4AI5ALwAjkAjDibnKx+R08GneTSwSq/V5GPLxgbH4HB2JTcrH53Vvhh2q2xGbkYvO7GZIfBm31Cbm2xGbk0ofULdm7XK9JfNcP/eu8XrSlOUCuLYFcI+8pl5StGVurX8i1JXYsl5xPv31ePtHT8nRnk+n6lIg6fkji3Wx+F8nkimMdL9TmZLhnflOLSIydxkhFrsWP1918PtgGezuVa/gSi4RYKve4BDnk5ncR1Ybvk17lpN/6PKurZJKNJMp2hvqJ3MX8zcT3Ze7e2Ia/L5/fxvh3yD7lypJhYD5ZcsqVRVDx/ec8UcJ5q21/r8TV9wu6TiAmWXbkD4Whv3m82I4csSy04Xc7yZJ1sS09Xj0Pmkr/9bXV8YXW+TE4mFzhC6qWO8LTf0ze5Impkyr/sluxVfnIkHhF4ifJGZGyWkJLcy5G/aYKoU3Xl2mlDczNSUAElnnxIlfbq/VfXVuM35IpPz8Gx3otHL/coXxKhANufldFtREeJHoO0jmRbqvYUt/1odMPCR8jng+xtXjl/M3Fz+ezdX4MjvsPGiG50rKQIOH6rje/q6Lk8sR+htjJnJRxfL913ypyscHeenYkF1gjciUrckIuLrRALhjwq05l9RxBrltBLhhfY5fFQa5buZtcbH4Hj8bd5AJ4NJALwAjkAjACuQCMQC4AI5ALwAjkAjACuQCMQC4AI5ALwAjkAjACuQCMQC4AI5ALwAjkAjACuQCMQC4AI5ALwAjkAjACuQCMQC4AI5ALwAjkAjACuQBM6Pt/AN+QtLkMvaQAAAAASUVORK5CYII=",t="/vitepress-note/assets/配置完成后.b6ffcef2.png",u=JSON.parse('{"title":"配置本地开发时的 https 环境","description":"","frontmatter":{},"headers":[],"relativePath":"fed/localhost-https.md","lastUpdated":1681872046000}'),c={name:"fed/localhost-https.md"},r=l('<h1 id="配置本地开发时的-https-环境" tabindex="-1">配置本地开发时的 https 环境 <a class="header-anchor" href="#配置本地开发时的-https-环境" aria-label="Permalink to &quot;配置本地开发时的 https 环境&quot;">​</a></h1><p>在开发某些功能时, 需要在本地服务器启用 Https 协议. 解决方案是在本地服务器中使用自签证书. 同时, 为了解决浏览器信任问题, 我们需要将自签证书使用的 CA 证书添加到系统或浏览器的可信 CA 证书中. 本文使用 <code>mkcert</code> 完成上述流程.</p><h2 id="安装-mkcert" tabindex="-1">安装 mkcert <a class="header-anchor" href="#安装-mkcert" aria-label="Permalink to &quot;安装 mkcert&quot;">​</a></h2><p>Windows 中可以使用 Chocolatey 安装 mkcert, 也可以在<a href="https://github.com/FiloSottile/mkcert/releases" target="_blank" rel="noreferrer">GitHub</a>上下载安装包.</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">choco</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mkcert</span></span></code></pre></div><h2 id="加入本地可信-ca" tabindex="-1">加入本地可信 CA <a class="header-anchor" href="#加入本地可信-ca" aria-label="Permalink to &quot;加入本地可信 CA&quot;">​</a></h2><p>将 mkcert 使用的根证书加入本地可信 CA 中, 这样由 mkcert 生成, 签发的证书在本地都是可信的。</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">mkcert</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-install</span></span></code></pre></div><p>Windows 系统可打开&quot;管理用户证书&quot;功能, 查找到 mkcert 的根证书证明操作生效.</p><p><img src="'+e+'" alt="搜索证书"></p><p><img src="'+p+'" alt="管理用户证书"></p><h2 id="生成自签证书" tabindex="-1">生成自签证书 <a class="header-anchor" href="#生成自签证书" aria-label="Permalink to &quot;生成自签证书&quot;">​</a></h2><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">mkcert</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">domain1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">domain2 </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">...</span><span style="color:#89DDFF;">]]</span></span></code></pre></div><p>直接跟多个要签发的域名或 ip 就行了，比如签发一个仅本机访问的证书(可以通过 127.0.0.1 和 localhost，以及 ipv6 地址::1 访问)</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">mkcert</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">localhost</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">127.0.0.1</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">::</span><span style="color:#F78C6C;">1</span></span></code></pre></div><p>成功生成了 localhost+2.pem 证书文件和 localhost+2-key.pem 私钥文件</p><p><img src="'+o+`" alt="生成文件"></p><h2 id="使用证书文件" tabindex="-1">使用证书文件 <a class="header-anchor" href="#使用证书文件" aria-label="Permalink to &quot;使用证书文件&quot;">​</a></h2><p>在本地的 node 服务中使用证书, 不同项目的配置本质上都是将 pem 文件传递给<code>https.createServer</code>函数</p><h3 id="vite-项目配置" tabindex="-1">Vite 项目配置 <a class="header-anchor" href="#vite-项目配置" aria-label="Permalink to &quot;Vite 项目配置&quot;">​</a></h3><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">server</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#FFCB6B;">https</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// 填入实际的证书与私钥文件名称及路径</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#FFCB6B;">key</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFileSync</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./localhost+2-key.pem</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#FFCB6B;">cert</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFileSync</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./localhost+2.pem</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h3 id="webpack-项目配置" tabindex="-1">Webpack 项目配置 <a class="header-anchor" href="#webpack-项目配置" aria-label="Permalink to &quot;Webpack 项目配置&quot;">​</a></h3><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#FFCB6B;">devServer</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#FFCB6B;">https</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// 填入实际的证书与私钥文件名称及路径</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#FFCB6B;">key</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFileSync</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./localhost+2-key.pem</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#FFCB6B;">cert</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFileSync</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./localhost+2.pem</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h2 id="配置后的效果" tabindex="-1">配置后的效果 <a class="header-anchor" href="#配置后的效果" aria-label="Permalink to &quot;配置后的效果&quot;">​</a></h2><p><img src="`+t+'" alt="配置完成后"></p><h2 id="ref" tabindex="-1">ref <a class="header-anchor" href="#ref" aria-label="Permalink to &quot;ref&quot;">​</a></h2><ul><li><a href="https://juejin.cn/post/7104650674880643108" target="_blank" rel="noreferrer">掘金:【Vite】配置 HTTPS&amp;自签名证书</a></li><li><a href="https://juejin.cn/post/6844904116481687565" target="_blank" rel="noreferrer">掘金:本地 https 服务搭建指南</a></li><li><a href="https://www.jianshu.com/p/7cb5c2cffaaa" target="_blank" rel="noreferrer">简书:本地 https 快速解决方案——mkcert</a></li><li><a href="https://github.com/FiloSottile/mkcert" target="_blank" rel="noreferrer">GitHub:mkcert</a></li></ul>',27),i=[r];function F(y,A,h,D,C,d){return n(),a("div",null,i)}const k=s(c,[["render",F]]);export{u as __pageData,k as default};
